<div class="admin-container">
  <h2>Admin Panel</h2>

  <div class="add-faction">
    <input type="text" [(ngModel)]="newFactionName" placeholder="New Faction Name">
    <button (click)="addFaction()">Add Faction</button>
  </div>

  <div class="import-factions">
    <input type="text" [(ngModel)]="importUrl" placeholder="Import URL">
    <button (click)="importFactions()">Import Factions</button>
    <br/><i>https://wahapedia.ru/wh40k10ed/the-rules/core-rules/</i>
  </div>

  <div *ngFor="let faction of factions" class="faction">
    <h3 (click)="toggleFaction(faction)">{{ faction.name }}</h3>
    <button (click)="renameFaction(faction)">Rename</button>
    <button (click)="deleteFaction(faction)">Delete</button>
    <div *ngIf="selectedFaction === faction">
      <div class="import-units">
        <input type="text" [(ngModel)]="unitImportUrl" placeholder="Import Units URL">
        <button (click)="importUnits(faction)">Import Units</button>
      </div>
      <div class="category" *ngFor="let category of categories">
        <h4 (click)="toggleCategory(faction, category)">{{ category | titlecase }}</h4>
        <div *ngIf="selectedCategory === category">
          <ul>
            <li *ngFor="let unit of getUnits(faction, category)">
              <a [href]="unit.url" target="_blank">{{ unit.name }}</a>
              <button (click)="renameUnit(faction, category, unit.name)">Rename</button>
              <button (click)="deleteUnit(faction, category, unit.name)">Delete</button>
            </li>
          </ul>
          <input type="text" [(ngModel)]="newUnitName" placeholder="New {{ category === 'detachments' ? 'Detachment' : 'Unit' }} Name">
          <button (click)="addUnit(faction, category)">
            {{ category === 'detachments' ? 'Add Detachment' : 'Add Unit' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
